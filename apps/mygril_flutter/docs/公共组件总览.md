# 公共组件总览（小白版）

这份文档用最简单的语言，告诉你项目里有哪些"现成的零件"可以直接用。

## 🤔 什么是公共组件？

想象你在搭乐高：
- **公共组件** = 预制好的乐高积木块
- 不用每次都从零开始做，直接拿来用就行
- 改一处，所有用到它的地方都会变

## 📱 界面零件

### 1. MoeAppBar - 页面顶部栏

📄 `lib/src/core/widgets/moe_app_bar.dart`

**是什么**：每个页面最上面那一条，显示标题和按钮的地方

**长什么样**：
- 粉色背景（浅色模式下）
- 左边可能有返回箭头
- 中间是标题文字
- 右边可能有操作按钮（比如 + 号）

**用在哪**：设置页、角色卡页、个人资料页……几乎所有页面的顶部

---

### 2. MoeToast - 提示气泡

📄 `lib/src/core/widgets/moe_toast.dart`

**是什么**：操作后弹出的小提示，过几秒自动消失

**长什么样**：屏幕上方出现一个圆角小条，显示文字，比如"保存成功"

**用在哪**：
- 点击"功能开发中"的按钮时
- 保存设置成功时
- 操作出错时（会变成红色）

---

### 3. ContactsSubHeader - 联系人列表小标题

📄 `lib/src/features/chat/presentation/widgets/contacts_sub_header.dart`

**是什么**：联系人列表上方的那一小条

**长什么样**：左边显示"未读消息 (3)"，右边有排序按钮

**用在哪**：消息列表页面、宽屏模式的左侧边栏
 
---

### 4. CustomBottomNav - 底部导航栏

📄 `lib/src/features/chat/presentation/widgets/custom_bottom_nav.dart`

**是什么**：屏幕最下面的三个图标按钮

**长什么样**：三个图标（消息、角色卡、我的），点哪个切换到哪个页面

**用在哪**：窄屏模式下的主页面底部

---

### 5. SettingsDrawerPanel - 设置侧边栏

📄 `lib/src/core/widgets/settings_drawer_panel.dart`

**是什么**：从侧面滑出来的设置面板

**长什么样**：一个带标题"设置"的面板，里面是各种设置项

**用在哪**：点击菜单按钮后滑出的设置界面

---

## 🎬 动画效果

### 1. ExpandingPageRoute - 卡片展开动画

📄 `lib/src/core/widgets/expanding_page_route.dart`

**是什么**：点击一个卡片，卡片"变大"成一整个页面的效果

**效果描述**：
1. 你点击一张角色卡片
2. 这张卡片从原来的位置"撑开"
3. 慢慢铺满整个屏幕
4. 变成了详情页面

**用在哪**：角色卡页面，点击卡片进入编辑页

---

### 2. ParallaxSlidePageRoute - 滑动切换动画

📄 `lib/src/core/widgets/parallax_slide_page_route.dart`

**是什么**：类似 iPhone 的页面切换效果

**效果描述**：
1. 新页面从右边滑进来
2. 同时旧页面往左边稍微移动一点
3. 形成一种"景深"的感觉

**用在哪**：进入设置子页面（模型设置、语音设置等）

---

## 🪟 毛玻璃效果

### 1. GradientBlurCard - 渐变高斯模糊卡片

📄 `lib/src/core/widgets/gradient_blur_card.dart`

**是什么**：功能入口卡片，带粉白渐变 + 高斯模糊背景效果

**效果描述**：
1. 粉白渐变背景 + 高斯模糊
2. 自动适配亮/暗色模式
3. iOS 风格平滑圆角
4. 左侧圆形图标 + 右侧标题/副标题

**用法**：
```dart
GradientBlurCard(
  title: '我的角色卡',
  subtitle: '3 个收藏',
  icon: Icons.favorite,
  iconColor: Colors.pinkAccent,
  onTap: () => print('点击了'),
)
```

**用在哪**：发现页顶部的"我的角色卡"、"定制角色卡"入口

---

### 2. FrostedGlassCard - 毛玻璃卡片

📄 `lib/src/core/widgets/frosted_glass_card.dart`

**是什么**：一个带动态取色 + 高斯模糊背景的卡片组件

**效果描述**：
1. 从传入的图片自动提取主色调
2. 用提取的颜色生成渐变背景
3. 加上毛玻璃模糊效果
4. 暗色模式下自动调整颜色，避免"脏"色

**用法**：
```dart
FrostedGlassCard(
  imageProvider: AssetImage('assets/characters/Arona.webp'),
  width: 300,
  onTap: () => print('点击了'),
  child: Text('卡片内容'),
)
```

**用在哪**：角色卡片、音乐播放器风格的卡片

---

### 2. FrostedGlassContainer - 毛玻璃容器

📄 `lib/src/core/widgets/frosted_glass_card.dart`

**是什么**：简单的半透明模糊容器（不带动态取色）

**长什么样**：一个有磨砂玻璃质感的容器，带细边框

**用法**：
```dart
FrostedGlassContainer(
  padding: EdgeInsets.all(12),
  child: Text('内容'),
)
```

**用在哪**：简介气泡、弹窗、悬浮卡片

---

## 🔲 图片处理

### 1. SmoothClipRRect - 圆角裁剪

📄 `lib/src/core/widgets/smooth_clip.dart`

**是什么**：让图片的四个角变成圆弧，而且是 iPhone 那种特别顺滑的圆角

**用在哪**：头像、角色卡封面

---

### 2. ImageCropDialog - 图片裁剪

📄 `lib/src/core/widgets/image_crop_dialog.dart`

**是什么**：选择图片后，可以拖动、缩放、裁剪成想要的形状

**用在哪**：设置用户头像、角色头像时

---

## 💬 聊天相关

### 1. MessageBubble - 聊天气泡

📄 `lib/src/features/chat/presentation/widgets/message_bubble.dart`

**是什么**：聊天界面里一条一条的消息框

**长什么样**：
- 你发的消息：蓝色气泡，靠右边
- AI 发的消息：灰色气泡，靠左边
- 左上角或右上角是直角，其他角是圆的（MoeTalk 风格）

**用在哪**：聊天页面

---

### 2. CharacterListItem - 联系人卡片

📄 `lib/src/features/chat/presentation/widgets/character_list_item.dart`

**是什么**：消息列表里的一行，显示一个角色

**长什么样**：左边头像，右边名字和最后一条消息

**用在哪**：消息列表、宽屏左侧栏

---

### 3. Composer - 输入框

📄 `lib/src/features/chat/presentation/widgets/composer.dart`

**是什么**：聊天页面最下面的输入区域

**长什么样**：
- 左边一个 + 号按钮（展开更多功能）
- 中间是输入框
- 右边是发送按钮

**用在哪**：聊天页面底部

---

## 🎨 皮肤系统

📄 `lib/src/core/theme/skin_config.dart` - 皮肤配置接口  
📄 `lib/src/core/theme/skin_provider.dart` - 皮肤状态管理  
📄 `lib/src/core/theme/skins/moetalk_skin.dart` - MoeTalk 默认皮肤

**是什么**：让整个 App 可以"换肤"的系统

**能干什么**：
- 切换不同的视觉风格
- 比如从"简约蓝"换成"毛玻璃风格"
- 所有页面的颜色、圆角、边框都会跟着变

**详见**：[皮肤系统.md](皮肤系统.md)

---

## 📝 总结

| 零件名 | 一句话说明 | 文件位置 |
|--------|-----------|----------|
| MoeAppBar | 页面顶部标题栏 | `core/widgets/moe_app_bar.dart` |
| MoeToast | 弹出的小提示 | `core/widgets/moe_toast.dart` |
| CustomBottomNav | 底部三个按钮 | `chat/.../widgets/custom_bottom_nav.dart` |
| MessageBubble | 聊天气泡 | `chat/.../widgets/message_bubble.dart` |
| CharacterListItem | 联系人一行 | `chat/.../widgets/character_list_item.dart` |
| Composer | 输入框+发送 | `chat/.../widgets/composer.dart` |
| ExpandingPageRoute | 卡片展开动画 | `core/widgets/expanding_page_route.dart` |
| ParallaxSlidePageRoute | 滑动切换动画 | `core/widgets/parallax_slide_page_route.dart` |
| GradientBlurCard | 渐变高斯模糊卡片 | `core/widgets/gradient_blur_card.dart` |
| FrostedGlassCard | 动态取色毛玻璃卡片 | `core/widgets/frosted_glass_card.dart` |
| FrostedGlassContainer | 毛玻璃容器 | `core/widgets/frosted_glass_card.dart` |
| SmoothClipRRect | 圆角裁剪 | `core/widgets/smooth_clip.dart` |
| ImageCropDialog | 图片裁剪 | `core/widgets/image_crop_dialog.dart` |
| ContactsSubHeader | 联系人小标题 | `chat/.../widgets/contacts_sub_header.dart` |
| SettingsDrawerPanel | 设置侧边栏 | `core/widgets/settings_drawer_panel.dart` |

> 注：`chat/...` 是 `features/chat/presentation` 的缩写

---

## 📅 更新记录

| 日期 | 做了什么 |
|------|---------|
| 2025-12-08 | 新增 GradientBlurCard 渐变高斯模糊卡片组件 |
| 2025-12-07 | 新增毛玻璃组件（FrostedGlassCard、FrostedGlassContainer），支持动态取色 |
| 2025-12-06 | 创建皮肤系统，让 App 可以换肤 |
| 2025-12-06 | 统一了顶部栏、提示气泡、底部导航的样式 |
| 2025-12-01 | 创建了卡片展开动画、滑动切换动画 |
